# CoOccSim
R script and functions used to simulate patterns of co-occurrence among two hypothetical species under patterns of avoidance, aggregation, and independence and code to summarize and analyze simulation results

Author: Robert C. Lonsinger
Affiliation: U.S. Geological Survey, Oklahoma Cooperative Fish and Wildlife Research Unit, Oklahoma State University, 007 Agriculture Hall, Stillwater, OK 74078, USA

Files:
Simulation_Code.R - Includes an R script and functions used to generate simulations and perform analyses presented in "Co-occurrence models fail to infer underlying patterns of avoidance and aggregation when closure is violated." 

SimGrid_sites.xls - a single input file, which represents the center points of grid cells in a hypothetical landscape.

Details:
The associated R script simulates patterns of occurrence for two hypothetical species (Species A and Species B) across a simple continuous landscape comprised of 900 equal-sized grid cells (represented by the SimGrid_sites file) without environmental variation. Species A was assumed to be dominant and Species B was assumed to be subordinate (sensu Richmond et al. 2010). For simplicity, occupancy of a site by either species was assumed to be by a single individual and, therefore, there was no abundance-induced heterogeneity in p. Species A was randomly distributed across the landscape such that true occupancy of Species A (ΨA) was 0.4, 0.55, or 0.7. Species B was then distributed across the landscape using one of three scenarios in relation to Species A: (i) the occurrence of Species B was negatively associated with the occurrence of Species A (i.e., avoidance); (ii) the occurrence of Species B was positively associated with the occurrence of Species A (i.e., aggregation); or (iii) the occurrence of Species B was not influenced by the occurrence of Species A (i.e., independence). For simulations of avoidance, Species B was randomly distributed across the landscape such that true occupancy of Species B given Species A was present (ΨBA) and true occupancy of Species B given Species A was absent (ΨBa) was 0.25 and 0.65, 0.35 and 0.75, or 0.45 and 0.85, respectively.  For simulations of aggregation, Species B was randomly distributed across the landscape such that ΨBA and ΨBa was 0.65 and 0.25, 0.75 and 0.35, or 0.85 and 0.45, respectively. For simulations of independence, Species B was randomly distributed across the landscape such that ΨB (i.e., ΨBA = ΨBa) was 0.45, 0.55, or 0.65 (i.e., the average values of ΨBA and ΨBa combinations used for simulations of avoidance or aggregation).

The performance of conditional two-species occupancy models was evaluated when the closure assumption was either (i) met or (ii) not met. To evaluate model performance when closure was met, 500 simulated patterns of co-occurrence were generated for each combination of occupancy parameters, maintaining the initial distributions of Species A and Species B during sampling. To evaluate model performance when closure was not met (i.e., species could move among sites between surveys), 500 simulated patterns of co-occurrence for each combination of occupancy parameters were generated, which served as the initial distribution. For simplicity, it was assumed (i) both species had the capacity to move among sites between surveys, (ii) the probability of movement (M) from an occupied site to another site between surveys was the same for both species (MA = MB = M), and (iii) M = 0.02. Between surveys, movements by the dominant species (Species A) were independent of the subordinate species (Species B). For Species A, the order in which individuals moved was randomized, individuals were permitted to move between each survey, and, when an individual moved from a site, the settlement site was probabilistically selected as a function of the site’s availability (i.e., not currently occupied by the same species) and distance from the starting site, such that movements were more likely to nearby available sites. For simulations in which ΨBA = ΨBa, the same process was repeated to simulate movements for Species B. For simulations in which ΨBA ≠ ΨBa, the settlement site was probabilistically selected for Species B as a function of the site’s availability, distance from the starting site, and ΨBA (when Species A was present at a site) or ΨBa (when Species A was not present at a site).

Detection probability (p) for Species A (pA) and Species B (pB) was held constant at 0.05 (i.e., pA = pB = 0.05) and the probability of detection for each species was assumed to be (i) independent of the presence or detection of the other species and (ii) constant over time. Species-specific encounter histories were generated for N = 250 randomly sampled sites over J = 21 replicated surveys (hereafter, fine-scale temporal resolution). Surveys were also collapsed to J = 3 survey occasions, where each occasion contained 7 sequential surveys of the initial 21 surveys. Finally, all the simulation procedures were repeated with a sample size reduced from N = 250 to N = 100 randomly sampled sites. 

For each set of conditions, sample data were analyzed using two competing single-season, conditional two-species models (Richmond et al. 2010): (i) a model in which the occurrence of Species A influenced the occurrence of Species B (i.e., ΨA, ΨBA ≠ ΨBa; where ΨBA and ΨBa were estimated separately); and, (ii) a model for independence between Species A and Species B (i.e., ΨA, ΨBA = ΨBa ; where ΨBA and ΨBa were not estimated separately and were presented collectively as ΨB). The detection submodels for each species was held constant (i.e., the null model), regardless of occupancy or detection state of the other species. All occupancy analyses were performed within an information-theoretic approach in program R with the ‘wiqid’ package (Meredith 2020). For each model set, relative support for competing models was evaluated with Akaike’s Information Criterion with sample size correction (AICc; Burnham and Anderson 2002), excluding models that failed to converge. When the most-supported model suggested that Species A influenced Species B (i.e., support for a model of influence), the species interaction factor (SIF) was calculated following Richmond et al. (2010). A SIF < 1 suggested avoidance (i.e., Species B occurred less frequently with Species A than expected compared to a null hypothesis of independence), whereas a SIF > 1 suggested aggregation (i.e., Species B occurred more frequently with Species A than expected). A SIF = 1 suggested the two species occurred independently of one another.

For each set of conditions, the reliability of the occupancy estimates from the most-supported models was summarized across simulations. Percent bias of occupancy estimates relative to the true parameter values were calculated for each simulation with the ‘SimDesign’ package in R (Chalmers and Adkins 2020). Percent bias was summarized as the mean bias for each parameter and set of conditions. To characterize overall performance under each set of conditions, the proportion of simulations that found support for the true pattern of co-occurrence was summarized. For each set of conditions, the expected (or true) SIF was calculated (sensu Richmond et al. 2010) and  compared the mean SIF (across simulations when a model of influence was most supported). 
